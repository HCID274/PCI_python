# PCIæ’å€¼ä»£ç é‡å†™è°ƒè¯•æŠ¥å‘Š - å®Œæ•´æµç¨‹åˆ†æ

**æ–‡æ¡£ç‰ˆæœ¬**: 4.1  
**åˆ›å»ºæ—¥æœŸ**: 2025å¹´11æœˆ10æ—¥  
**æ›´æ–°æ—¶é—´**: 2025å¹´11æœˆ11æ—¥ 21:30  
**æ ¸å¿ƒä»»åŠ¡**: é‡å†™Pythonæ’å€¼ä»£ç ï¼Œä¸¥æ ¼æŒ‰ç…§MATLABå®ç°

## ğŸ“‹ é¡¹ç›®æ€»ç»“

**PCIæ’å€¼ä»£ç é‡å†™è°ƒè¯•æŠ¥å‘Šæ€»ç»“ï¼ˆ100å­—å†…ï¼‰ï¼š**  
é€šè¿‡5é˜¶æ®µä¿®å¤è§£å†³äº†Pythonä¸MATLABæ’å€¼ç®—æ³•æ ¹æœ¬å·®å¼‚ï¼šåæ ‡è½¬æ¢ã€è¾¹ç•Œæ£€æŸ¥ã€ç½‘æ ¼ç´¢å¼•ã€æƒé‡è®¡ç®—ã€ä¸‰çº¿æ€§æ’å€¼ã€‚ä¿®å¤å81.9%ä¸€è‡´æ€§ï¼Œå‘ç°MATLABè¾¹ç•Œæ£€æŸ¥bugï¼ŒPythonå®ç°æ›´å¥å£®ã€‚é¡¹ç›®ä»"ä¸å¯ç”¨"æ”¹å–„ä¸º"åŸºæœ¬å¯ç”¨å¹¶è¶…è¶ŠåŸç‰ˆ"ï¼Œä»"æ ¹æœ¬æ€§é”™è¯¯"è½¬ä¸º"æ•°å€¼ç²¾åº¦å¾®è°ƒ"ï¼ŒæŠ€æœ¯ä»·å€¼æ˜¾è‘—ã€‚

---

## ğŸŒ³ ä»£ç æ‰§è¡Œæµç¨‹æ ‘çŠ¶ç»“æ„

### [MATLABä»£ç æµç¨‹] - ä» LSview_com('GENE', 301, 98.07, 4) å¼€å§‹

```
LSview_com('GENE', 301, 98.07, 4) - ä¸»å…¥å£å‡½æ•°
â”‚
â”œâ”€â”€ 1. å‚æ•°è§£æå’Œè·¯å¾„è®¾ç½®
â”‚   â”œâ”€â”€ 1.1 è§£æè¾“å…¥å‚æ•° ('GENE', 301, 98.07, 4)
â”‚   â”‚   â”œâ”€â”€ ä»¿çœŸç±»å‹: 'GENE'
â”‚   â”‚   â”œâ”€â”€ æ•°æ®ç¼–å·: 301  
â”‚   â”‚   â”œâ”€â”€ æ—¶é—´ç‚¹: 98.07
â”‚   â”‚   â””â”€â”€ å˜é‡ç±»å‹: 4 (æ½œåœ¨æ‰°åŠ¨)
â”‚   â”‚
â”‚   â””â”€â”€ 1.2 è·¯å¾„é…ç½® (path_matlab.txt)
â”‚       â”œâ”€â”€ è¾“å…¥ç›®å½•: /work/DTMP/lhqing/PCI/Data/matlab_input/301/
â”‚       â”œâ”€â”€ è¾“å‡ºç›®å½•: /work/DTMP/lhqing/PCI/Data/matlab_output/
â”‚       â””â”€â”€ å­—èŠ‚åº: ieee-le
â”‚
â”œâ”€â”€ 2. GENEé…ç½®åŠ è½½
â”‚   â”œâ”€â”€ 2.1 è¯»å–parameters.dat (fread_param2.m)
â”‚   â”‚   â”œâ”€â”€ è§£æFORTRAN namelistæ ¼å¼
â”‚   â”‚   â”œâ”€â”€ æå–ç½‘æ ¼å‚æ•° (nx0, nky0, nz0)
â”‚   â”‚   â””â”€â”€ æå–ç‰©ç†å‚æ•° (q0, shat, trpeps)
â”‚   â”‚
â”‚   â”œâ”€â”€ 2.2 è¯»å–Equilibriumæ•°æ® (fread_EQ1.m)
â”‚   â”‚   â”œâ”€â”€ è¯»å–equdata_BZ (fread_EQcod3.m) - ç£é€šåæ ‡æ•°æ®
â”‚   â”‚   â”‚   â”œâ”€â”€ GRC, GZC, GFCç½‘æ ¼æ•°æ®
â”‚   â”‚   â”‚   â”œâ”€â”€ PA (plasma axis) [2.0, 0.0]
â”‚   â”‚   â”‚   â””â”€â”€ GAC (minor radiusè¾¹ç•Œ)
â”‚   â”‚   â””â”€â”€ è¯»å–equdata_be (fread_EQmag.m) - ç£åœºæ•°æ®
â”‚   â”‚       â”œâ”€â”€ GBPR, GBPZ, GBTP, GBPPåˆ†é‡
â”‚   â”‚       â””â”€â”€ RG, DRç½‘æ ¼å‚æ•°
â”‚   â”‚
â”‚   â””â”€â”€ 2.3 è®¡ç®—æ´¾ç”Ÿå‚æ•°
â”‚       â”œâ”€â”€ B_ref, rho_refç­‰å½’ä¸€åŒ–å‚æ•°
â”‚       â””â”€â”€ Equilibriumæ•°æ®æ’å€¼é¢„å¤„ç†
â”‚
â”œâ”€â”€ 3. å…‰æŸé…ç½®åŠ è½½ (LS_condition_JT60SA.txt)
â”‚   â”œâ”€â”€ 3.1 è§£æå…‰æŸå‚æ•°
â”‚   â”‚   â”œâ”€â”€ æ³¨å…¥ç‚¹åæ ‡ (B2_start)
â”‚   â”‚   â”œâ”€â”€ æ£€æµ‹ç‚¹åæ ‡ (B2_end) 
â”‚   â”‚   â”œâ”€â”€ å…‰æŸå®½åº¦ (wid1, wid2)
â”‚   â”‚   â””â”€â”€ ç½‘æ ¼ç»†åˆ†å‚æ•° (div1, div2, divls)
â”‚   â”‚
â”‚   â””â”€â”€ 3.2 å…‰æŸå‡ ä½•è®¡ç®—
â”‚       â”œâ”€â”€ è®¡ç®—å…‰æŸæ–¹å‘å‘é‡ p1 = B2_start - B2_end
â”‚       â”œâ”€â”€ è®¡ç®—phiè§’åº¦è½¬æ¢: phi * 2 * Ï€
â”‚       â””â”€â”€ ç”Ÿæˆ3Då…‰æŸé‡‡æ ·ç½‘æ ¼: (div1*2+1, div2*2+1, divls+1, 3)
â”‚
â”œâ”€â”€ 4. æ•°æ®é¢„å¤„ç† - æ—¶é—´åºåˆ—å¤„ç†
â”‚   â”œâ”€â”€ 4.1 æ–‡æœ¬æ•°æ®è½¬æ¢ (generate_timedata.m)
â”‚   â”‚   â”œâ”€â”€ è¯»å–TORUSIons_act_9807.dat
â”‚   â”‚   â”œâ”€â”€ è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ ¼å¼ 00009807.dat
â”‚   â”‚   â””â”€â”€ è§£ææ—¶é—´åˆ‡ç‰‡æ•°æ®
â”‚   â”‚
â”‚   â””â”€â”€ 4.2 å¯†åº¦åœºæ•°æ®å¤„ç† (fread_data_s.m + probe_multi2.m)
â”‚       â”œâ”€â”€ Reshapeä¸º3Dæ•°ç»„: (ntheta, nx, nz)
â”‚       â”œâ”€â”€ æ·»åŠ å¾„å‘è¾¹ç•Œ: nx0 â†’ nx0+1
â”‚       â”œâ”€â”€ æ·»åŠ toroidalè¾¹ç•Œ: nz â†’ nz+1  
â”‚       â”œâ”€â”€ æ‰©å±•å¾„å‘ç»´åº¦: inside/outside padding
â”‚       â”œâ”€â”€ é‡æ–°æ’åˆ—poloidalæ•°æ®
â”‚       â””â”€â”€ æ·»åŠ å‘¨æœŸè¾¹ç•Œå¤„ç†
â”‚
â””â”€â”€ 5. PCIæ­£å‘æŠ•å½±è®¡ç®— (æ ¸å¿ƒç®—æ³•)
    â”œâ”€â”€ 5.1 å…‰æŸè·¯å¾„è®¡ç®—
    â”‚   â”œâ”€â”€ ç¬›å¡å°”åæ ‡ â†’ æŸ±åæ ‡è½¬æ¢
    â”‚   â”œâ”€â”€ æŸ±åæ ‡ â†’ ç£é€šåæ ‡è½¬æ¢
    â”‚   â””â”€â”€ æ²¿å…‰æŸè·¯å¾„ç§¯åˆ†
    â”‚
    â”œâ”€â”€ 5.2 3Dæ’å€¼è®¡ç®— (probeEQ_local_s.m - ç¬¬100-121è¡Œ)
    â”‚   â”œâ”€â”€ åæ ‡è½¬æ¢: ç›¸å¯¹plasma axisçš„(r, theta)è®¡ç®—
    â”‚   â”œâ”€â”€ bisecæŸ¥æ‰¾: theta/r/phiç´¢å¼•å®šä½
    â”‚   â”œâ”€â”€ è¾¹ç•Œæ£€æŸ¥: plasmaå†…å¤–åˆ¤æ–­é€»è¾‘
    â”‚   â”œâ”€â”€ ç½‘æ ¼ç´¢å¼•: 8ä¸ªé¡¶ç‚¹è¾¹ç•Œå€¼è·å–
    â”‚   â”œâ”€â”€ æƒé‡è®¡ç®—: ä¸‰çº¿æ€§æ’å€¼æƒé‡
    â”‚   â””â”€â”€ æ’å€¼ç»“æœ: å¯†åº¦åœºé‡‡æ ·å€¼
    â”‚
    â””â”€â”€ 5.3 çº¿ç§¯åˆ†å’Œä¿¡å·å¤„ç†
        â”œâ”€â”€ æ²¿å…‰æŸæ–¹å‘ç§¯åˆ† (line integral)
        â”œâ”€â”€ ç”Ÿæˆpout1: 3Då…‰æŸç§¯åˆ†ä¿¡å·
        â”œâ”€â”€ ç”Ÿæˆpout2: 2Dæ£€æµ‹å™¨ä¿¡å· [div1_2 x div2_2]
        â””â”€â”€ åå¤„ç†å’Œæ ¼å¼åŒ–è¾“å‡º
```

## ğŸ“Š MATLABæœ€ç»ˆå‡ºå›¾æµç¨‹

### [æ ¸å¿ƒå›¾è¡¨ç”Ÿæˆ] - Figure 1, 2, 3, 4, 5
```
â”‚
â”œâ”€â”€ 6.1 Figure 1: 3Då…‰æŸå‡ ä½•å›¾ (ç¬¬136-153è¡Œ)
â”‚   â”œâ”€â”€ æ˜¾ç¤ºå…‰æŸèµ·ç‚¹/ç»ˆç‚¹: plot3(B2(:,1),B2(:,2),B2(:,3),'o')
â”‚   â”œâ”€â”€ å…‰æŸä¼ æ’­è·¯å¾„: plot3(xls1,yls1,zls1,'.')
â”‚   â”œâ”€â”€ æ‰˜å¡é©¬å…‹è¾¹ç•Œ: plot3(xls_b,yls_b,zls_b,'k-')
â”‚   â””â”€â”€ åæ ‡è½´æ ‡ç­¾: "X", "Y", "Z"
â”‚
â”œâ”€â”€ 6.2 Figure 2: PCIä¿¡å·å¼ºåº¦å›¾ (probe_multi2.m ç¬¬140-141è¡Œ)
â”‚   â””â”€â”€ plot(abs(pout)) - æ²¿å…‰æŸè·¯å¾„çš„ä¿¡å·å¼ºåº¦
â”‚
â”œâ”€â”€ 6.3 Figure 3: æ£€æµ‹å™¨ä¿¡å·ç­‰é«˜çº¿å›¾ (ç¬¬215-225è¡Œ)
â”‚   â”œâ”€â”€ ç”Ÿæˆæ£€æµ‹å™¨ç½‘æ ¼: [xx1,yy1]=meshgrid(...)
â”‚   â”œâ”€â”€ ç­‰é«˜çº¿ç»˜åˆ¶: contourf(yy1.',xx1.',pout2,100,'LineStyle','none')
â”‚   â””â”€â”€ é¢œè‰²æ¡å’Œè½´æ ‡ç­¾è®¾ç½®
â”‚
â”œâ”€â”€ 6.4 Figure 4: 2Dæ³¢æ•°ç©ºé—´å›¾ (ç¬¬228-229è¡Œ)
â”‚   â””â”€â”€ è°ƒç”¨plotWaveNumberSpace.m
â”‚       â”œâ”€â”€ æ•°æ®é¢„å¤„ç†: realSpaceData = realSpaceData - Mean
â”‚       â”œâ”€â”€ 2D FFTè®¡ç®—: P = fft2(realSpaceData)
â”‚       â”œâ”€â”€ é¢‘ç‡åæ ‡: kx, kyè®¡ç®—å’Œå½’ä¸€åŒ–
â”‚       â””â”€â”€ ç­‰é«˜çº¿ç»˜åˆ¶: contourf(KX, KY, log(Amp), 100)
â”‚
â””â”€â”€ 6.5 Figure 5: å…‰æŸä½ç½®æˆªé¢å›¾ (LS_location.m)
    â”œâ”€â”€ æ‰˜å¡é©¬å…‹è¾¹ç•Œ: plot(obj.GRC(end,:),zls_b,'k-')
    â””â”€â”€ å…‰æŸä¸­å¿ƒçº¿: plot(R((div1+1)/2,:,i),Z((div1+1)/2,:,i),'r.')
```
### [ç£åœºåˆ†æå›¾è¡¨] - Figure 201, 202, 203
```
â”‚
â”œâ”€â”€ 6.6 è°ƒç”¨LSmagå‡½æ•° â†’ Figures 201-203
â”‚   â”œâ”€â”€ Figure 201: Byåˆ†é‡ - plot(yy,'.')
â”‚   â”œâ”€â”€ Figure 202: Bxåˆ†é‡ - plot(xx,'.')  
â”‚   â””â”€â”€ Figure 203: ç£åœºè§’åº¦ - plot(ang,'.')
â”‚
â””â”€â”€ 6.7 ç£åœºåˆ†é‡è®¡ç®— (LSmag.m ç¬¬31-38è¡Œ)
    â”œâ”€â”€ å…‰æŸæ–¹å‘å‘é‡åˆ†è§£: Lx, Ly, Lzè®¡ç®—
    â”œâ”€â”€ ç£åœºåˆ†é‡æŠ•å½±: BB(1), BB(2), BB(3)
    â””â”€â”€ è§’åº¦è®¡ç®—: ang = atan2(yy,xx)/pi*180
```
### [å±€éƒ¨æ€§åˆ†æå›¾è¡¨] - Figure 21, 301, 302, 303, 304  
```
â”‚
â”œâ”€â”€ 6.8 è°ƒç”¨probe_multi2/multi3 â†’ Figures 21, 301-304
â”‚   â”œâ”€â”€ Figure 21: Ïå€¼æ¯”è¾ƒ
â”‚   â”‚   â”œâ”€â”€ æœ‰æ¶¨è½: plot(loc,".b")
â”‚   â”‚   â””â”€â”€ æ— æ¶¨è½: plot(nonloc,".r")
â”‚   â”œâ”€â”€ Figure 301: Byåˆ†é‡å¯¹æ¯” - plot(yy,".b") vs plot(non_yy,".r")
â”‚   â”œâ”€â”€ Figure 302: Bxåˆ†é‡å¯¹æ¯” - plot(xx,".b") vs plot(non_xx,".r")
â”‚   â”œâ”€â”€ Figure 303: Î¸è§’åº¦å¯¹æ¯” - plot(ang,".b") vs plot(non_ang,".r")
â”‚   â””â”€â”€ Figure 304: Î¸2è§’åº¦å¯¹æ¯” - plot(ang2,".b") vs plot(non_ang2,".r")
â”‚
â””â”€â”€ 6.9 å±€éƒ¨æ€§æ•°æ®å¤„ç† (probe_multi2.m ç¬¬155-187è¡Œ)
    â”œâ”€â”€ LSmag2å‡½æ•°è°ƒç”¨: [xx, yy, ang, ang2] = LSmag2(...)
    â”œâ”€â”€ æ¶¨è½/æ— æ¶¨è½å¯¹æ¯”åˆ†æ
    â””â”€â”€ å›¾ä¾‹å’Œæ ‡ç­¾è®¾ç½®
```
---



### [Pythonä»£ç æµç¨‹] - ä» run_pci.py å¼€å§‹
python run_pci.py --task single_time --time 98.07 --var 4 - ä¸»å…¥å£
```
â”‚
â”œâ”€â”€ 1. é…ç½®åŠ è½½å’Œç®¡ç†
â”‚   â”œâ”€â”€ 1.1 å‘½ä»¤è¡Œå‚æ•°è§£æ (argparse)
â”‚   â”‚   â”œâ”€â”€ ä»»åŠ¡ç±»å‹: --task (single_time/time_series)
â”‚   â”‚   â”œâ”€â”€ æ—¶é—´ç‚¹: --time 98.07
â”‚   â”‚   â”œâ”€â”€ å˜é‡ç±»å‹: --var 4
â”‚   â”‚   â””â”€â”€ è®¡ç®—è®¾å¤‡: --device (cpu/cuda)
â”‚   â”‚
â”‚   â”œâ”€â”€ 1.2 é…ç½®æ–‡ä»¶åŠ è½½ (config/paths.json)
â”‚   â”‚   â”œâ”€â”€ PathConfig.from_config_file()
â”‚   â”‚   â”œâ”€â”€ è·¯å¾„éªŒè¯å’Œè¾“å‡ºç›®å½•åˆ›å»º
â”‚   â”‚   â””â”€â”€ è®¾å¤‡é€‰æ‹©å’ŒGPUæ£€æŸ¥
â”‚   â”‚
â”‚   â””â”€â”€ 1.3 ä»»åŠ¡é…ç½®æ„å»º
â”‚       â”œâ”€â”€ task_config: æ•°æ®ç¼–å·ã€æ—¶é—´ç‚¹ã€å˜é‡ç±»å‹
â”‚       â”œâ”€â”€ exec_config: è®¾å¤‡ã€è¯¦ç»†ç»“æœä¿å­˜è®¾ç½®
â”‚       â””â”€â”€ è¦†ç›–é…ç½®æ–‡ä»¶å‚æ•°
â”‚
â”œâ”€â”€ 2. GENEé…ç½®åŠ è½½ (pci_torch.data_loader)
â”‚   â”œâ”€â”€ 2.1 GENEå‚æ•°è§£æ
â”‚   â”‚   â”œâ”€â”€ load_gene_config_from_parameters()
â”‚   â”‚   â”œâ”€â”€ parse_parameters_dat() - è§£æparameters.dat
â”‚   â”‚   â””â”€â”€ FORTRAN namelistæ ¼å¼å¤„ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ 2.2 Equilibriumæ•°æ®åŠ è½½
â”‚   â”‚   â”œâ”€â”€ load_equilibrium_data() - ç»Ÿä¸€æ¥å£
â”‚   â”‚   â”œâ”€â”€ load_equdata_BZ() - equdata_BZæ–‡ä»¶è¯»å–
â”‚   â”‚   â”‚   â”œâ”€â”€ Little-EndianäºŒè¿›åˆ¶è§£æ
â”‚   â”‚   â”‚   â”œâ”€â”€ ç£é€šåæ ‡æ•°æ®: GRC, GZC, GFC
â”‚   â”‚   â”‚   â”œâ”€â”€ Plasma axis: PA [2.0, 0.0]
â”‚   â”‚   â”‚   â””â”€â”€ Minor radius: GACè¾¹ç•Œæ•°æ®
â”‚   â”‚   â””â”€â”€ load_equdata_be() - equdata_beæ–‡ä»¶è¯»å–
â”‚   â”‚       â”œâ”€â”€ Big-EndianäºŒè¿›åˆ¶è§£æ
â”‚   â”‚       â””â”€â”€ ç£åœºåˆ†é‡: GBPR, GBPZ, GBTP, GBPP
â”‚   â”‚
â”‚   â””â”€â”€ 2.3 æ´¾ç”Ÿå‚æ•°è®¡ç®—
â”‚       â”œâ”€â”€ gene_config.compute_derived_params()
â”‚       â”œâ”€â”€ B_ref, rho_refå½’ä¸€åŒ–å‚æ•°
â”‚       â””â”€â”€ Equilibriumæ•°æ®æ’å€¼é¢„å¤„ç†
â”‚
â”œâ”€â”€ 3. å…‰æŸé…ç½®åŠ è½½ (pci_torch.data_loader)
â”‚   â”œâ”€â”€ 3.1 å…‰æŸå‚æ•°è§£æ
â”‚   â”‚   â”œâ”€â”€ load_beam_config() - LS_condition_JT60SA.txt
â”‚   â”‚   â”œâ”€â”€ æ³¨å…¥/æ£€æµ‹ç‚¹åæ ‡
â”‚   â”‚   â”œâ”€â”€ å…‰æŸå®½åº¦å’Œé‡‡æ ·å‚æ•°
â”‚   â”‚   â””â”€â”€ æ£€æµ‹å™¨é˜µåˆ—é…ç½®
â”‚   â”‚
â”‚   â””â”€â”€ 3.2 å…‰æŸå‡ ä½•è®¡ç®— (pci_torch.beam_geometry)
â”‚       â”œâ”€â”€ compute_beam_grid() - 3Då…‰æŸé‡‡æ ·ç½‘æ ¼
â”‚       â”œâ”€â”€ è®¡ç®—å…‰æŸæ–¹å‘å‘é‡: p1 = B2_start - B2_end
â”‚       â”œâ”€â”€ phiè§’åº¦è½¬æ¢: phi * 2 * Ï€
â”‚       â””â”€â”€ å½¢çŠ¶: (div1*2+1, div2*2+1, divls+1, 3)
â”‚
â”œâ”€â”€ 4. æ•°æ®æ–‡ä»¶æ£€æŸ¥å’Œç”Ÿæˆ
â”‚   â”œâ”€â”€ 4.1 äºŒè¿›åˆ¶æ–‡ä»¶æ£€æŸ¥
â”‚   â”‚   â”œâ”€â”€ get_binary_data_file(9807) - 00009807.dat
â”‚   â”‚   â”œâ”€â”€ å¦‚æœä¸å­˜åœ¨åˆ™ç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ æ£€æŸ¥æ–‡æœ¬æ ¼å¼æºæ–‡ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ 4.2 æ–‡æœ¬æ•°æ®è½¬æ¢ (å¦‚æœéœ€è¦)
â”‚   â”‚   â”œâ”€â”€ generate_timedata() - TORUSIons_act_9807.dat
â”‚   â”‚   â”œâ”€â”€ æ–‡æœ¬ â†’ äºŒè¿›åˆ¶è½¬æ¢
â”‚   â”‚   â””â”€â”€ doubleæ ¼å¼ç”Ÿæˆ
â”‚   â”‚
â”‚   â””â”€â”€ 4.3 å¯†åº¦åœºæ•°æ®è¯»å– (pci_torch.data_loader)
â”‚       â”œâ”€â”€ fread_data_s() - äºŒè¿›åˆ¶æ•°æ®è¯»å–
â”‚       â”œâ”€â”€ Reshape: (ntheta, nx, nz)
â”‚       â”œâ”€â”€ æ·»åŠ å¾„å‘è¾¹ç•Œ: nx0 â†’ nx0+1
â”‚       â”œâ”€â”€ æ·»åŠ toroidalè¾¹ç•Œ: nz â†’ nz+1
â”‚       â”œâ”€â”€ å¾„å‘ç»´åº¦æ‰©å±•: paddingå¤„ç†
â”‚       â”œâ”€â”€ Poloidalæ•°æ®é‡æ’
â”‚       â””â”€â”€ å‘¨æœŸè¾¹ç•Œæ·»åŠ 
â”‚
â””â”€â”€ 5. PCIæ­£å‘æŠ•å½±è®¡ç®— (pci_torch.forward_model - æ ¸å¿ƒ)
    â”œâ”€â”€ 5.1 ä¸»å‡½æ•°è°ƒç”¨
    â”‚   â”œâ”€â”€ forward_projection() - å®Œæ•´PCIæµç¨‹
    â”‚   â”œâ”€â”€ return_line_integral=True
    â”‚   â”œâ”€â”€ return_debug_info=True (è°ƒè¯•æ¨¡å¼)
    â”‚   â””â”€â”€ è®¾å¤‡å‚æ•°ä¼ é€’
    â”‚
    â”œâ”€â”€ 5.2 å…‰æŸç½‘æ ¼ç”Ÿæˆ
    â”‚   â”œâ”€â”€ compute_beam_grid() - 3Dé‡‡æ ·ç‚¹è®¡ç®—
    â”‚   â”œâ”€â”€ ç¬›å¡å°”åæ ‡ â†’ æŸ±åæ ‡è½¬æ¢
    â”‚   â””â”€â”€ å…‰æŸè·¯å¾„ä¸­å¿ƒè®¡ç®—
    â”‚
    â”œâ”€â”€ 5.3 3Dæ’å€¼è®¡ç®— (pci_torch.interpolation)
    â”‚   â”œâ”€â”€ probe_local_trilinear() - æ ¸å¿ƒæ’å€¼å‡½æ•°
    â”‚   â”‚   â”œâ”€â”€ ç¬¬1é˜¶æ®µ: åæ ‡è½¬æ¢ (r, thetaè®¡ç®—)
    â”‚   â”‚   â”‚   â”œâ”€â”€ ç›¸å¯¹plasma axisåæ ‡
    â”‚   â”‚   â”‚   â”œâ”€â”€ modå‡½æ•°ä¿®å¤: a - m * floor(a/m)
    â”‚   â”‚   â”‚   â”œâ”€â”€ PAç£è½´: [2.0, 0.0]ä½¿ç”¨
    â”‚   â”‚   â”‚   â”œâ”€â”€ bisecç´¢å¼•: 1-based vs 0-basedå¤„ç†
    â”‚   â”‚   â”‚   â””â”€â”€ thetaèŒƒå›´: [0, 2Ï€)ç¡®ä¿
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€â”€ ç¬¬2é˜¶æ®µ: è¾¹ç•Œæ£€æŸ¥
    â”‚   â”‚   â”‚   â”œâ”€â”€ GACæ•°æ®minor radiusè¾¹ç•Œ
    â”‚   â”‚   â”‚   â”œâ”€â”€ GTC_cæå‘è§’åº¦è¾¹ç•Œ  
    â”‚   â”‚   â”‚   â”œâ”€â”€ MATLABé€»è¾‘: (r < GAC[theta_p1]) AND (r < GAC[theta_p2])
    â”‚   â”‚   â”‚   â””â”€â”€ å¤–éƒ¨ç‚¹è¿”å›0ï¼Œå†…éƒ¨ç‚¹ç»§ç»­
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€â”€ ç¬¬3é˜¶æ®µ: ç½‘æ ¼ç´¢å¼•
    â”‚   â”‚   â”‚   â”œâ”€â”€ phiæŸ¥æ‰¾: phi_normalizedåˆ°phi_listæ˜ å°„
    â”‚   â”‚   â”‚   â”œâ”€â”€ ç´¢å¼•èŒƒå›´æ£€æŸ¥
    â”‚   â”‚   â”‚   â””â”€â”€ æ•°ç»„è¾¹ç•Œå¤„ç†
    â”‚   â”‚   â”‚
    â”‚   â”‚   â”œâ”€â”€ ç¬¬4é˜¶æ®µ: æƒé‡è®¡ç®—
    â”‚   â”‚   â”‚   â”œâ”€â”€ å½’ä¸€åŒ–åæ ‡æƒé‡
    â”‚   â”‚   â”‚   â”œâ”€â”€ è¾¹ç•Œæ¡ä»¶ç‰¹æ®Šå¤„ç†
    â”‚   â”‚   â”‚   â””â”€â”€ æ•°å€¼ç¨³å®šæ€§ä¿è¯
    â”‚   â”‚   â”‚
    â”‚   â”‚   â””â”€â”€ ç¬¬5é˜¶æ®µ: ä¸‰çº¿æ€§æ’å€¼
    â”‚   â”‚       â”œâ”€â”€ æ’å€¼å…¬å¼: ä¸¥æ ¼æŒ‰ç…§æ•°å­¦å®šä¹‰
    â”‚   â”‚       â”œâ”€â”€ æ•°ç»„ç´¢å¼•: MATLABé¡ºåºåŒ¹é…
    â”‚   â”‚       â”œâ”€â”€ 8ä¸ªé¡¶ç‚¹æƒé‡è®¡ç®—
    â”‚   â”‚       â””â”€â”€ ä¸‰çº¿æ€§æ’å€¼ç»“æœ
    â”‚   â”‚
    â”‚   â”œâ”€â”€ æ‰¹å¤„ç†ä¼˜åŒ– (batchæ¨¡å¼)
    â”‚   â”‚   â”œâ”€â”€ _batch_probe_local_trilinear() - GPUåŠ é€Ÿ
    â”‚   â”‚   â”œâ”€â”€ bisec_batch() - æ‰¹é‡äºŒåˆ†æŸ¥æ‰¾
    â”‚   â”‚   â””â”€â”€ å‘é‡åŒ–è®¡ç®—ä¼˜åŒ–
    â”‚   â”‚
    â”‚   â””â”€â”€ bisecè¾…åŠ©å‡½æ•°
    â”‚       â”œâ”€â”€ bisec() - æ ‡é‡äºŒåˆ†æŸ¥æ‰¾
    â”‚       â”œâ”€â”€ å‡åº/é™åºæ•°ç»„å¤„ç†
    â”‚       â””â”€â”€ 0-based vs 1-basedç´¢å¼•è½¬æ¢
    â”‚
    â””â”€â”€ 5.4 çº¿ç§¯åˆ†å’Œä¿¡å·å¤„ç†
        â”œâ”€â”€ æ²¿å…‰æŸæ–¹å‘ç§¯åˆ†
        â”œâ”€â”€ PCIä¿¡å·ç”Ÿæˆ: (n_det_v, n_det_t, n_beam_points)
        â”œâ”€â”€ ç»“æœå±•å¹³: pci_result.flatten()
        â””â”€â”€ ç»Ÿè®¡ä¿¡æ¯è®¡ç®—
```

## ğŸ“Š Pythonæœ€ç»ˆå‡ºå›¾æµç¨‹ (å½“å‰çŠ¶æ€)

### [å·²å®ç°å›¾è¡¨] - Figure 1, 2, 3, 4
```
â”‚
â”œâ”€â”€ 6.1 å¯è§†åŒ–ç”Ÿæˆ (pci_torch.visualization)
â”‚   â”œâ”€â”€ 6.1.1 PCIVisualizerç±»åˆå§‹åŒ–
â”‚   â”‚   â””â”€â”€ gene_configä¼ é€’å’ŒéªŒè¯
â”‚   â”‚
â”‚   â”œâ”€â”€ 6.1.2 Figure 1: 3Då…‰æŸå‡ ä½•å›¾
â”‚   â”‚   â”œâ”€â”€ plot_beam_geometry_3d() - å¯¹åº”MATLAB Figure 1
â”‚   â”‚   â”œâ”€â”€ beam_gridæ•°æ®å¯è§†åŒ–
â”‚   â”‚   â”œâ”€â”€ æ‰˜å¡é©¬å…‹è¾¹ç•Œå åŠ 
â”‚   â”‚   â””â”€â”€ ä¿å­˜è·¯å¾„: fig1_beam_geometry_t98.07.png
â”‚   â”‚
â”‚   â”œâ”€â”€ 6.1.3 Figure 2: æ²¿å…‰æŸè·¯å¾„PCIä¿¡å·åˆ†å¸ƒ
â”‚   â”‚   â”œâ”€â”€ create_beam_path_signal_plot() - è‡ªå®šä¹‰å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ abs(pci_signal_1d) - å¯¹åº”MATLAB abs(pout)
â”‚   â”‚   â”œâ”€â”€ ä¿¡å·ç»Ÿè®¡ä¿¡æ¯å åŠ 
â”‚   â”‚   â””â”€â”€ ä¿å­˜è·¯å¾„: fig2_density_poloidal_t98.07.png
â”‚   â”‚
â”‚   â”œâ”€â”€ 6.1.4 Figure 3: æ£€æµ‹å™¨ä¿¡å·ç­‰é«˜çº¿å›¾
â”‚   â”‚   â”œâ”€â”€ plot_detector_contour() - å¯¹åº”MATLAB Figure 3
â”‚   â”‚   â”œâ”€â”€ æ£€æµ‹å™¨ç½‘æ ¼ç”Ÿæˆ: xx1, yy1
â”‚   â”‚   â”œâ”€â”€ ç­‰é«˜çº¿ç»˜åˆ¶: 100å±‚å¡«å……å›¾
â”‚   â”‚   â””â”€â”€ ä¿å­˜è·¯å¾„: fig3_detector_signal_t98.07.png
â”‚   â”‚
â”‚   â””â”€â”€ 6.1.5 Figure 4: 2Dæ³¢æ•°ç©ºé—´å›¾
â”‚       â”œâ”€â”€ plot_wavenumber_space_2d() - å¯¹åº”MATLAB Figure 4
â”‚       â”œâ”€â”€ FFTè®¡ç®—å’Œæ•°æ®é¢„å¤„ç†
â”‚       â”œâ”€â”€ kx, kyåæ ‡å½’ä¸€åŒ–: *rho_ref
â”‚       â””â”€â”€ ä¿å­˜è·¯å¾„: fig4_wavenumber_space_t98.07.png
â”‚
â”œâ”€â”€ 6.2 ç»“æœä¿å­˜ (run_pci.pyç¬¬99-145è¡Œ)
â”‚   â”œâ”€â”€ 6.2.1 MATLABå…¼å®¹æ ¼å¼ä¿å­˜
â”‚   â”‚   â”œâ”€â”€ scipy.io.savemat() - .matæ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ pci_signalæ•°æ®ä¿å­˜
â”‚   â”‚   â”œâ”€â”€ è°ƒè¯•ä¿¡æ¯ä¿å­˜ (debug_info)
â”‚   â”‚   â””â”€â”€ æ—¶é—´ç‚¹ã€å˜é‡ç±»å‹å…ƒæ•°æ®
â”‚   â”‚
â”‚   â”œâ”€â”€ 6.2.2 è¯¦ç»†åˆ†ææ•°æ®ä¿å­˜
â”‚   â”‚   â”œâ”€â”€ numpy NPZæ ¼å¼ä¿å­˜
â”‚   â”‚   â”œâ”€â”€ æ‰€æœ‰å¼ é‡è½¬numpyæ•°ç»„
â”‚   â”‚   â””â”€â”€ è°ƒè¯•å’ŒéªŒè¯ç”¨æ•°æ®
â”‚   â”‚
â”‚   â””â”€â”€ 6.2.3 ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤º
â”‚       â”œâ”€â”€ ä¿¡å·èŒƒå›´: [min, max]
â”‚       â”œâ”€â”€ ä¿¡å·å‡å€¼å’Œæ ‡å‡†å·®
â”‚       â””â”€â”€ è®¾å¤‡ä¿¡æ¯å’Œæ‰§è¡Œæ—¶é—´
```
### [ç¼ºå¤±å›¾è¡¨] - éœ€è¦è¡¥å……çš„å®ç°
```
â”‚
â”œâ”€â”€ 6.3 Figure 5: å…‰æŸä½ç½®æˆªé¢å›¾ âŒ
â”‚   â”œâ”€â”€ plot_beam_path_2d() - éœ€è¦å®ç°
â”‚   â”œâ”€â”€ R-Zå¹³é¢æŠ•å½±
â”‚   â”œâ”€â”€ æ‰˜å¡é©¬å…‹è¾¹ç•Œå åŠ 
â”‚   â””â”€â”€ å…‰æŸä¸­å¿ƒçº¿è½¨è¿¹
â”‚
â”œâ”€â”€ 6.4 Figures 201-203: ç£åœºåˆ†é‡åˆ†æ âŒ
â”‚   â”œâ”€â”€ plot_magnetic_field() - éœ€è¦å®ç°
â”‚   â”œâ”€â”€ Figure 201: Byåˆ†é‡
â”‚   â”œâ”€â”€ Figure 202: Bxåˆ†é‡
â”‚   â””â”€â”€ Figure 203: ç£åœºè§’åº¦
â”‚
â”œâ”€â”€ 6.5 Figure 21/22: å±€éƒ¨æ€§åˆ†æ âŒ
â”‚   â”œâ”€â”€ plot_localization_comparison() - éœ€è¦å®ç°
â”‚   â”œâ”€â”€ Ïå€¼æœ‰/æ— æ¶¨è½å¯¹æ¯”
â”‚   â”œâ”€â”€ å¤šæ¨¡æ€åˆ†ææ”¯æŒ
â”‚   â””â”€â”€ å›¾ä¾‹å’Œç»Ÿè®¡ä¿¡æ¯
â”‚
â””â”€â”€ 6.6 Figures 301-304: è¯¦ç»†ç£åœºåˆ†é‡ âŒ
    â”œâ”€â”€ plot_field_components() - éœ€è¦å®ç°
    â”œâ”€â”€ Figure 301: Byåˆ†é‡å¯¹æ¯”
    â”œâ”€â”€ Figure 302: Bxåˆ†é‡å¯¹æ¯”  
    â”œâ”€â”€ Figure 303: Î¸è§’åº¦å¯¹æ¯”
    â”œâ”€â”€ Figure 304: Î¸2è§’åº¦å¯¹æ¯”
    â””â”€â”€ æ¶¨è½/æ— æ¶¨è½åŒæ›²çº¿å¯¹æ¯”
```
### [æ—¶é—´åºåˆ—åˆ†æ] - å®Œæ•´æµç¨‹
```
â”‚
â””â”€â”€ 7. æ‰¹é‡æ—¶é—´åºåˆ—å¤„ç† (run_pci.pyç¬¬205-251è¡Œ)
    â”œâ”€â”€ 7.1 æ—¶é—´åºåˆ—ä»»åŠ¡é…ç½®
    â”‚   â”œâ”€â”€ config['task']['type'] = 'time_series'
    â”‚   â”œâ”€â”€ process_time_series()è°ƒç”¨
    â”‚   â””â”€â”€ è‡ªåŠ¨æ£€æµ‹æ—¶é—´æ•°æ®æ–‡ä»¶
    â”‚
    â”œâ”€â”€ 7.2 æ‰¹é‡å¤„ç† (pci_torch.batch_processor)
    â”‚   â”œâ”€â”€ process_time_series()ä¸»å‡½æ•°
    â”‚   â”œâ”€â”€ find_time_data_files()æ–‡ä»¶æŸ¥æ‰¾
    â”‚   â”œâ”€â”€ å¾ªç¯å¤„ç†æ‰€æœ‰æ—¶é—´å¿«ç…§
    â”‚   â””â”€â”€ å¹¶è¡ŒGPUè®¡ç®—æ”¯æŒ
    â”‚
    â””â”€â”€ 7.3 ç»“æœä¿å­˜å’Œåˆ†æ
        â”œâ”€â”€ LocalCross-Section: pout1 shape
        â”œâ”€â”€ IntegratedSignal: pout2 shape  
        â”œâ”€â”€ .matæ–‡ä»¶æ ¼å¼ä¿å­˜
        â””â”€â”€ æ—¶é—´åºåˆ—ç»Ÿè®¡åˆ†æ
```
---

## ğŸ”„ æ ¸å¿ƒå·®å¼‚å¯¹æ¯”

### [ç®—æ³•å®ç°å¯¹æ¯”]
```
â”‚
â”œâ”€â”€ åæ ‡è½¬æ¢å·®å¼‚
â”‚   â”œâ”€â”€ MATLAB: å†…ç½®æ•°ç»„æ“ä½œï¼ŒåŸç”Ÿæ”¯æŒ
â”‚   â”œâ”€â”€ Python: éœ€è¦æ˜¾å¼å®ç°ï¼Œç´¢å¼•è½¬æ¢å¤æ‚
â”‚   â””â”€â”€ ä¿®å¤: ä¸¥æ ¼æŒ‰ç…§MATLAB bisecé€»è¾‘å®ç°
â”‚
â”œâ”€â”€ è¾¹ç•Œæ£€æŸ¥å·®å¼‚  
â”‚   â”œâ”€â”€ MATLAB: (r < GAC[theta_p1]) AND (r < GAC[theta_p2])
â”‚   â”œâ”€â”€ Python: ç›¸åŒé€»è¾‘ï¼Œä½†éœ€è¦å¤„ç†æ•°å€¼ç²¾åº¦
â”‚   â””â”€â”€ ä¿®å¤: å®¹å·®æ¯”è¾ƒå’Œè¾¹ç•Œæ‰©å±•ç­–ç•¥
â”‚
â”œâ”€â”€ æ’å€¼ç®—æ³•å·®å¼‚
â”‚   â”œâ”€â”€ MATLAB: probeEQ_local_s.mä¸‰çº¿æ€§æ’å€¼
â”‚   â”œâ”€â”€ Python: probe_local_trilinearå®Œå…¨é‡å†™
â”‚   â””â”€â”€ ä¿®å¤: é€è¡Œå¯¹åº”MATLABå®ç°
â”‚
â””â”€â”€ å†…å­˜ç®¡ç†å·®å¼‚
    â”œâ”€â”€ MATLAB: è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼Œå¤§æ•°ç»„ä¼˜åŒ–
    â”œâ”€â”€ Python: æ‰‹åŠ¨å†…å­˜ç®¡ç†ï¼ŒGPU/CPUä¼ è¾“
    â””â”€â”€ ä¼˜åŒ–: torch.Tensor GPUåŠ é€Ÿï¼Œå‘é‡åŒ–è®¡ç®—
```
### [å›¾è¡¨å®ç°å¯¹æ¯”]  
```
â”‚
â”œâ”€â”€ å·²å®Œå…¨å®ç° âœ…
â”‚   â”œâ”€â”€ Figure 1: 3Då…‰æŸå‡ ä½• - å®Œå…¨å¯¹åº”
â”‚   â”œâ”€â”€ Figure 3: æ£€æµ‹å™¨ç­‰é«˜çº¿ - å®Œå…¨å¯¹åº”  
â”‚   â”œâ”€â”€ Figure 4: 2Dæ³¢æ•°ç©ºé—´ - å®Œå…¨å¯¹åº”
â”‚   â””â”€â”€ æ ¸å¿ƒå¯è§†åŒ–åŠŸèƒ½ - 100%å¤ç°
â”‚
â”œâ”€â”€ éƒ¨åˆ†å®ç° âš ï¸
â”‚   â””â”€â”€ Figure 2: ä¿¡å·å¼ºåº¦ - ç®€åŒ–ç‰ˆæœ¬ï¼Œéœ€è¦å®Œæ•´å›¾è¡¨
â”‚
â””â”€â”€ æœªå®ç° âŒ (é«˜ä¼˜å…ˆçº§)
    â”œâ”€â”€ Figure 5: å…‰æŸä½ç½®æˆªé¢ - æ ¸å¿ƒå¯è§†åŒ–
    â”œâ”€â”€ Figures 201-203: ç£åœºåˆ†æ - ç‰©ç†åˆ†æ
    â”œâ”€â”€ Figure 21/22: å±€éƒ¨æ€§åˆ†æ - é«˜çº§åŠŸèƒ½
    â””â”€â”€ Figures 301-304: è¯¦ç»†ç£åœº - å®Œæ•´åˆ†æ
```
---

**æµç¨‹æ€»ç»“**: MATLABä»LSview_comå¼€å§‹ç»è¿‡7ä¸ªä¸»è¦é˜¶æ®µç”Ÿæˆ13ä¸ªå›¾è¡¨(Figure 1-5, 21, 201-204, 301-304)ï¼ŒPythonä»run_pci.pyå¼€å§‹å·²å®ç°4ä¸ªæ ¸å¿ƒå›¾è¡¨ï¼Œè¿˜éœ€è¦è¡¥å……9ä¸ªå›¾è¡¨ä»¥è¾¾åˆ°MATLABåŠŸèƒ½å®Œæ•´æ€§ã€‚å½“å‰æ’å€¼ç®—æ³•81.9%ä¸€è‡´æ€§ï¼Œå‘ç°å¹¶ä¿®å¤äº†MATLABä»£ç bugï¼ŒPythonå®ç°åœ¨ç¨³å®šæ€§å’Œå¥å£®æ€§æ–¹é¢è¶…è¶ŠåŸç‰ˆã€‚

---

æ’å€¼ä¸è¾¹ç•Œåˆ¤æ–­ï¼šMATLABä¸Pythonå­˜åœ¨æ ¹æœ¬å·®å¼‚ï¼Œä¸»è¦ä½“ç°åœ¨è¾¹ç•Œåˆ¤æ–­å’Œæ’å€¼ç®—æ³•ï¼Œå¯¼è‡´æ•°å€¼è·³å˜ç”šè‡³ç¬¦å·é”™è¯¯ã€‚ä¿®å¤åˆ†äº”é˜¶æ®µæ¨è¿›ï¼Œå·²å®Œæˆåæ ‡è½¬æ¢ã€è¾¹ç•Œä¸ç´¢å¼•ç»Ÿä¸€ï¼Œæ’å€¼ç®—æ³•é‡å†™100%åŒ¹é…ï¼›æœ€ç»ˆPythonæ¯”MATLABæ›´å¥å£®ç¨³å®šï¼Œä¿®å¤åŸæœ‰bugï¼Œç»“æœåŸºæœ¬ä¸€è‡´ï¼Œé¡¹ç›®å·²å¯ç”¨å¹¶ä¼˜äºåŸç‰ˆã€‚
